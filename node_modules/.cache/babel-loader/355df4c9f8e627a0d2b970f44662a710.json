{"remainingRequest":"/Users/twj/Documents/node/project/vue-cli-test/node_modules/babel-loader/lib/index.js!/Users/twj/Documents/node/project/vue-cli-test/node_modules/vue-loader-v16/dist/templateLoader.js??ref--6!/Users/twj/Documents/node/project/vue-cli-test/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/twj/Documents/node/project/vue-cli-test/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/twj/Documents/node/project/vue-cli-test/src/components/UploadFile.vue?vue&type=template&id=6988d2cd&scoped=true","dependencies":[{"path":"/Users/twj/Documents/node/project/vue-cli-test/src/components/UploadFile.vue","mtime":1624971600959},{"path":"/Users/twj/Documents/node/project/vue-cli-test/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/twj/Documents/node/project/vue-cli-test/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/twj/Documents/node/project/vue-cli-test/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":1616796459000},{"path":"/Users/twj/Documents/node/project/vue-cli-test/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/twj/Documents/node/project/vue-cli-test/node_modules/vue-loader-v16/dist/index.js","mtime":1616796459000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgcmVzb2x2ZUNvbXBvbmVudCBhcyBfcmVzb2x2ZUNvbXBvbmVudCwgY3JlYXRlVk5vZGUgYXMgX2NyZWF0ZVZOb2RlLCBvcGVuQmxvY2sgYXMgX29wZW5CbG9jaywgY3JlYXRlQmxvY2sgYXMgX2NyZWF0ZUJsb2NrLCBjcmVhdGVDb21tZW50Vk5vZGUgYXMgX2NyZWF0ZUNvbW1lbnRWTm9kZSwgd2l0aEN0eCBhcyBfd2l0aEN0eCwgd2l0aFNjb3BlSWQgYXMgX3dpdGhTY29wZUlkLCBwdXNoU2NvcGVJZCBhcyBfcHVzaFNjb3BlSWQsIHBvcFNjb3BlSWQgYXMgX3BvcFNjb3BlSWQgfSBmcm9tICJ2dWUiOwoKdmFyIF93aXRoSWQgPSAvKiNfX1BVUkVfXyovX3dpdGhTY29wZUlkKCJkYXRhLXYtNjk4OGQyY2QiKTsKCl9wdXNoU2NvcGVJZCgiZGF0YS12LTY5ODhkMmNkIik7Cgp2YXIgX2hvaXN0ZWRfMSA9IHsKICBjbGFzczogImNsZWFyZml4Igp9Owp2YXIgX2hvaXN0ZWRfMiA9IHsKICBrZXk6IDAKfTsKCl9wb3BTY29wZUlkKCk7CgpleHBvcnQgdmFyIHJlbmRlciA9IC8qI19fUFVSRV9fKi9fd2l0aElkKGZ1bmN0aW9uIChfY3R4LCBfY2FjaGUsICRwcm9wcywgJHNldHVwLCAkZGF0YSwgJG9wdGlvbnMpIHsKICB2YXIgX2NvbXBvbmVudF9hX2ljb24gPSBfcmVzb2x2ZUNvbXBvbmVudCgiYS1pY29uIik7CgogIHZhciBfY29tcG9uZW50X2FfdXBsb2FkID0gX3Jlc29sdmVDb21wb25lbnQoImEtdXBsb2FkIik7CgogIHZhciBfY29tcG9uZW50X2FfbW9kYWwgPSBfcmVzb2x2ZUNvbXBvbmVudCgiYS1tb2RhbCIpOwoKICByZXR1cm4gX29wZW5CbG9jaygpLCBfY3JlYXRlQmxvY2soImRpdiIsIF9ob2lzdGVkXzEsIFtfY3JlYXRlVk5vZGUoX2NvbXBvbmVudF9hX3VwbG9hZCwgewogICAgY3VzdG9tUmVxdWVzdDogJG9wdGlvbnMudXBsb2FkSW1nLAogICAgcmVtb3ZlOiAkb3B0aW9ucy5oYW5kbGVSZW1vdmUsCiAgICAibGlzdC10eXBlIjogInBpY3R1cmUtY2FyZCIsCiAgICAiZmlsZS1saXN0IjogJGRhdGEuZmlsZUxpc3QsCiAgICBvblByZXZpZXc6ICRvcHRpb25zLmhhbmRsZVByZXZpZXcsCiAgICBjbGFzczogImF2YXRhci11cGxvYWRlciIKICB9LCB7CiAgICBkZWZhdWx0OiBfd2l0aElkKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIFskZGF0YS5maWxlTGlzdC5sZW5ndGggPCAxID8gKF9vcGVuQmxvY2soKSwgX2NyZWF0ZUJsb2NrKCJkaXYiLCBfaG9pc3RlZF8yLCBbX2NyZWF0ZVZOb2RlKF9jb21wb25lbnRfYV9pY29uLCB7CiAgICAgICAgdHlwZTogInBsdXMiCiAgICAgIH0pXSkpIDogX2NyZWF0ZUNvbW1lbnRWTm9kZSgidi1pZiIsIHRydWUpXTsKICAgIH0pLAogICAgXzogMQogICAgLyogU1RBQkxFICovCgogIH0sIDgKICAvKiBQUk9QUyAqLwogICwgWyJjdXN0b21SZXF1ZXN0IiwgInJlbW92ZSIsICJmaWxlLWxpc3QiLCAib25QcmV2aWV3Il0pLCBfY3JlYXRlVk5vZGUoX2NvbXBvbmVudF9hX21vZGFsLCB7CiAgICB2aXNpYmxlOiAkZGF0YS5wcmV2aWV3VmlzaWJsZSwKICAgIGZvb3RlcjogbnVsbCwKICAgIG9uQ2FuY2VsOiAkb3B0aW9ucy5oYW5kbGVDYW5jZWwKICB9LCB7CiAgICBkZWZhdWx0OiBfd2l0aElkKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIFtfY3JlYXRlVk5vZGUoImltZyIsIHsKICAgICAgICBhbHQ6ICJleGFtcGxlIiwKICAgICAgICBzdHlsZTogewogICAgICAgICAgIndpZHRoIjogIjEwMCUiCiAgICAgICAgfSwKICAgICAgICBzcmM6ICRkYXRhLnByZXZpZXdJbWFnZQogICAgICB9LCBudWxsLCA4CiAgICAgIC8qIFBST1BTICovCiAgICAgICwgWyJzcmMiXSldOwogICAgfSksCiAgICBfOiAxCiAgICAvKiBTVEFCTEUgKi8KCiAgfSwgOAogIC8qIFBST1BTICovCiAgLCBbInZpc2libGUiLCAib25DYW5jZWwiXSldKTsKfSk7"},{"version":3,"sources":["/Users/twj/Documents/node/project/vue-cli-test/src/components/UploadFile.vue"],"names":[],"mappings":";;;;;;;AACO,EAAA,KAAK,EAAC;;;;;;;;;;;;;;;uBAAX,YAAA,CAgBM,KAhBN,EAAA,UAAA,EAgBM,CAfJ,YAAA,CAWW,mBAXX,EAWW;AAVN,IAAA,aAAa,EAAE,QAAA,CAAA,SAUT;AATN,IAAA,MAAM,EAAE,QAAA,CAAA,YASF;AARP,iBAAU,cAQH;AAPN,iBAAW,KAAA,CAAA,QAOL;AANN,IAAA,SAAO,EAAE,QAAA,CAAA,aAMH;AALP,IAAA,KAAK,EAAC;AAKC,GAXX,E;qBAQE;AAAA,aAEM,CAFK,KAAA,CAAA,QAAA,CAAS,MAAT,GAAe,C,kBAA1B,YAAA,CAEM,KAFN,EAEM,UAFN,EAEM,CADJ,YAAA,CAAqB,iBAArB,EAAqB;AAAb,QAAA,IAAI,EAAC;AAAQ,OAArB,CACI,CAFN,C,qCAEM,CAFN;AAAA,K;;;;GARF,E;;AAAA,I,qDAAA,CAeI,EAHJ,YAAA,CAEU,kBAFV,EAEU;AAFA,IAAA,OAAO,EAAE,KAAA,CAAA,cAET;AAF0B,IAAA,MAAM,EAAE,IAElC;AAFyC,IAAA,QAAM,EAAE,QAAA,CAAA;AAEjD,GAFV,E;qBACE;AAAA,aAA2D,CAA3D,YAAA,CAA2D,KAA3D,EAA2D;AAAtD,QAAA,GAAG,EAAC,SAAkD;AAAxC,QAAA,KAAmB,EAAnB;AAAA,mBAAA;AAAA,SAAwC;AAAnB,QAAA,GAAG,EAAE,KAAA,CAAA;AAAc,OAA3D,E,IAAA,E;;AAAA,Q,OAAA,CAA2D,CAA3D;AAAA,K;;;;GADF,E;;AAAA,I,uBAAA,CAGI,CAhBN,C","sourcesContent":["<template>\n  <div class=\"clearfix\">\n    <a-upload\n        :customRequest=\"uploadImg\"\n        :remove=\"handleRemove\"\n        list-type=\"picture-card\"\n        :file-list=\"fileList\"\n        @preview=\"handlePreview\"\n        class=\"avatar-uploader\"\n    >\n      <div v-if=\"fileList.length < 1\">\n        <a-icon type=\"plus\"/>\n      </div>\n    </a-upload>\n    <a-modal :visible=\"previewVisible\" :footer=\"null\" @cancel=\"handleCancel\">\n      <img alt=\"example\" style=\"width: 100%\" :src=\"previewImage\">\n    </a-modal>\n  </div>\n\n</template>\n\n<script>\nimport {upload} from '@/api/function'\n\n\n// 转换图片格式的方法\nfunction getBase64(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader()\n    reader.readAsDataURL(file)\n    reader.onload = () => resolve(reader.result)\n    reader.onerror = error => reject(error)\n  })\n}\n\nexport default {\n  name: 'Function',\n  components: {\n    STable\n  },\n  data() {\n    return {\n      // 控制图片预览弹出层的显示与隐藏\n      previewVisible: false,\n      // 预览图片弹出层的图片路径\n      previewImage: '',\n      // 文件列表\n      fileList: [],\n    }\n  },\n  methods: {\n    // 处理函数，当编辑按钮被点击时触发\n    async onEditClick(record) {\n      try {\n        // 准备请求参数\n        // 发送请求\n        // 如果请求不成功,则终止函数执行\n        // 清空图片列表\n        this.fileList = []\n        this.$nextTick(() => {\n          //回填数据信息\n          setTimeout(() => {\n            // 图片上传组件填充图片\n            this.fileList1.push({\n              uid:-1,\n              status: 'done',\n              url: record.recordUrl\n            })\n          })\n        })\n      } catch (error) {}\n    },\n    // 处理函数，当关闭预览图片弹层时触发\n    handleCancel() {\n      this.previewVisible = false\n    },\n    // 处理函数，当预览图片时触发\n    async handlePreview(file) {\n      if (!file.url && !file.preview) {\n        file.preview = await getBase64(file.originFileObj)\n      }\n      this.previewImage = file.url || file.preview\n      this.previewVisible = true\n    },\n    // 上传图片的方法\n    async uploadPicture(file) {\n      try {\n        // 发送请求\n        const res = await upload({ file })\n        return\n      } catch (error) {}\n    },\n    // 上传图片的方法\n    uploadImg(file) {\n      const newData = new FormData()\n      const uid = file.file.uid\n      newData.append('File', file.file)\n      upload(newData).then(res => {\n        this.fileList = []\n        this.fileList.push({\n          uid: uid,\n          status: 'done',\n          url: res.url\n        })\n      })\n          .catch(err => {\n            console.log('失败', err)\n          })\n    },\n    // 删除图片的方法\n    handleRemove(file) {\n      const index = this.fileList.indexOf(file)\n      const newFileList = this.fileList.slice()\n      newFileList.splice(index, 1)\n      this.fileList = newFileList\n    },\n    // 处理函数，当提交添加表单时触发\n    handleSubmit() {\n      try {\n        // 对当前表单数据进行手动校验\n        this.form.validateFields(async (err, values) => {\n          // 如果表单数据校验不成功，终止函数执行\n          if (err) return\n          // 准备请求参数\n          const requestPayload = {purchaseVoucherUrl: this.fileList[0].url}\n          // 发送请求\n          const res = await add(requestPayload)\n          if(res.code !== 200) return this.$message.error('添加设备失败！')\n          // 提示用户\n          this.$message.success('添加设备成功！')\n          // 更新表格数据\n          this.getListData(1, 10)\n          // 关闭弹出层\n          this.visible = false\n        })\n      } catch (error) {\n        console.log('错误')\n      }\n    },\n  }\n}\n</script>\n\n<style scoped>\n.avatar-uploader > .ant-upload {\n  width: 128px;\n  height: 128px;\n}\n\n.ant-upload-select-picture-card i {\n  font-size: 32px;\n  color: #999;\n}\n\n.ant-upload-select-picture-card .ant-upload-text {\n  margin-top: 8px;\n  color: #666;\n}\n\n</style>\n"],"sourceRoot":""}]}