{"remainingRequest":"/Users/twj/Documents/node/project/vue-cli-test/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/twj/Documents/node/project/vue-cli-test/src/components/UploadFile.vue?vue&type=template&id=6988d2cd&scoped=true","dependencies":[{"path":"/Users/twj/Documents/node/project/vue-cli-test/src/components/UploadFile.vue","mtime":1624971600959},{"path":"/Users/twj/Documents/node/project/vue-cli-test/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/twj/Documents/node/project/vue-cli-test/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/twj/Documents/node/project/vue-cli-test/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":1616796459000},{"path":"/Users/twj/Documents/node/project/vue-cli-test/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/twj/Documents/node/project/vue-cli-test/node_modules/vue-loader-v16/dist/index.js","mtime":1616796459000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgPGRpdiBjbGFzcz0iY2xlYXJmaXgiPgogICAgPGEtdXBsb2FkCiAgICAgICAgOmN1c3RvbVJlcXVlc3Q9InVwbG9hZEltZyIKICAgICAgICA6cmVtb3ZlPSJoYW5kbGVSZW1vdmUiCiAgICAgICAgbGlzdC10eXBlPSJwaWN0dXJlLWNhcmQiCiAgICAgICAgOmZpbGUtbGlzdD0iZmlsZUxpc3QiCiAgICAgICAgQHByZXZpZXc9ImhhbmRsZVByZXZpZXciCiAgICAgICAgY2xhc3M9ImF2YXRhci11cGxvYWRlciIKICAgID4KICAgICAgPGRpdiB2LWlmPSJmaWxlTGlzdC5sZW5ndGggPCAxIj4KICAgICAgICA8YS1pY29uIHR5cGU9InBsdXMiLz4KICAgICAgPC9kaXY+CiAgICA8L2EtdXBsb2FkPgogICAgPGEtbW9kYWwgOnZpc2libGU9InByZXZpZXdWaXNpYmxlIiA6Zm9vdGVyPSJudWxsIiBAY2FuY2VsPSJoYW5kbGVDYW5jZWwiPgogICAgICA8aW1nIGFsdD0iZXhhbXBsZSIgc3R5bGU9IndpZHRoOiAxMDAlIiA6c3JjPSJwcmV2aWV3SW1hZ2UiPgogICAgPC9hLW1vZGFsPgogIDwvZGl2PgoK"},{"version":3,"sources":["/Users/twj/Documents/node/project/vue-cli-test/src/components/UploadFile.vue"],"names":[],"mappings":";EACE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACnB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACzB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACrB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACvB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACpB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACvB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC1B;MACE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;QAC7B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACtB,CAAC,CAAC,CAAC,CAAC,CAAC;IACP,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACtE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC5D,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACX,CAAC,CAAC,CAAC,CAAC,CAAC","file":"/Users/twj/Documents/node/project/vue-cli-test/src/components/UploadFile.vue","sourceRoot":"","sourcesContent":["<template>\n  <div class=\"clearfix\">\n    <a-upload\n        :customRequest=\"uploadImg\"\n        :remove=\"handleRemove\"\n        list-type=\"picture-card\"\n        :file-list=\"fileList\"\n        @preview=\"handlePreview\"\n        class=\"avatar-uploader\"\n    >\n      <div v-if=\"fileList.length < 1\">\n        <a-icon type=\"plus\"/>\n      </div>\n    </a-upload>\n    <a-modal :visible=\"previewVisible\" :footer=\"null\" @cancel=\"handleCancel\">\n      <img alt=\"example\" style=\"width: 100%\" :src=\"previewImage\">\n    </a-modal>\n  </div>\n\n</template>\n\n<script>\nimport {upload} from '@/api/function'\n\n\n// 转换图片格式的方法\nfunction getBase64(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader()\n    reader.readAsDataURL(file)\n    reader.onload = () => resolve(reader.result)\n    reader.onerror = error => reject(error)\n  })\n}\n\nexport default {\n  name: 'Function',\n  components: {\n    STable\n  },\n  data() {\n    return {\n      // 控制图片预览弹出层的显示与隐藏\n      previewVisible: false,\n      // 预览图片弹出层的图片路径\n      previewImage: '',\n      // 文件列表\n      fileList: [],\n    }\n  },\n  methods: {\n    // 处理函数，当编辑按钮被点击时触发\n    async onEditClick(record) {\n      try {\n        // 准备请求参数\n        // 发送请求\n        // 如果请求不成功,则终止函数执行\n        // 清空图片列表\n        this.fileList = []\n        this.$nextTick(() => {\n          //回填数据信息\n          setTimeout(() => {\n            // 图片上传组件填充图片\n            this.fileList1.push({\n              uid:-1,\n              status: 'done',\n              url: record.recordUrl\n            })\n          })\n        })\n      } catch (error) {}\n    },\n    // 处理函数，当关闭预览图片弹层时触发\n    handleCancel() {\n      this.previewVisible = false\n    },\n    // 处理函数，当预览图片时触发\n    async handlePreview(file) {\n      if (!file.url && !file.preview) {\n        file.preview = await getBase64(file.originFileObj)\n      }\n      this.previewImage = file.url || file.preview\n      this.previewVisible = true\n    },\n    // 上传图片的方法\n    async uploadPicture(file) {\n      try {\n        // 发送请求\n        const res = await upload({ file })\n        return\n      } catch (error) {}\n    },\n    // 上传图片的方法\n    uploadImg(file) {\n      const newData = new FormData()\n      const uid = file.file.uid\n      newData.append('File', file.file)\n      upload(newData).then(res => {\n        this.fileList = []\n        this.fileList.push({\n          uid: uid,\n          status: 'done',\n          url: res.url\n        })\n      })\n          .catch(err => {\n            console.log('失败', err)\n          })\n    },\n    // 删除图片的方法\n    handleRemove(file) {\n      const index = this.fileList.indexOf(file)\n      const newFileList = this.fileList.slice()\n      newFileList.splice(index, 1)\n      this.fileList = newFileList\n    },\n    // 处理函数，当提交添加表单时触发\n    handleSubmit() {\n      try {\n        // 对当前表单数据进行手动校验\n        this.form.validateFields(async (err, values) => {\n          // 如果表单数据校验不成功，终止函数执行\n          if (err) return\n          // 准备请求参数\n          const requestPayload = {purchaseVoucherUrl: this.fileList[0].url}\n          // 发送请求\n          const res = await add(requestPayload)\n          if(res.code !== 200) return this.$message.error('添加设备失败！')\n          // 提示用户\n          this.$message.success('添加设备成功！')\n          // 更新表格数据\n          this.getListData(1, 10)\n          // 关闭弹出层\n          this.visible = false\n        })\n      } catch (error) {\n        console.log('错误')\n      }\n    },\n  }\n}\n</script>\n\n<style scoped>\n.avatar-uploader > .ant-upload {\n  width: 128px;\n  height: 128px;\n}\n\n.ant-upload-select-picture-card i {\n  font-size: 32px;\n  color: #999;\n}\n\n.ant-upload-select-picture-card .ant-upload-text {\n  margin-top: 8px;\n  color: #666;\n}\n\n</style>\n"]}]}